{"payload":{"allShortcutsEnabled":false,"fileTree":{"src":{"items":[{"name":"img","path":"src/img","contentType":"directory"},{"name":"SUMMARY.md","path":"src/SUMMARY.md","contentType":"file"},{"name":"appendix-00.md","path":"src/appendix-00.md","contentType":"file"},{"name":"appendix-01-keywords.md","path":"src/appendix-01-keywords.md","contentType":"file"},{"name":"appendix-02-operators.md","path":"src/appendix-02-operators.md","contentType":"file"},{"name":"appendix-03-derivable-traits.md","path":"src/appendix-03-derivable-traits.md","contentType":"file"},{"name":"appendix-04-useful-development-tools.md","path":"src/appendix-04-useful-development-tools.md","contentType":"file"},{"name":"appendix-05-editions.md","path":"src/appendix-05-editions.md","contentType":"file"},{"name":"appendix-06-translation.md","path":"src/appendix-06-translation.md","contentType":"file"},{"name":"appendix-07-nightly-rust.md","path":"src/appendix-07-nightly-rust.md","contentType":"file"},{"name":"ch00-00-introduction.md","path":"src/ch00-00-introduction.md","contentType":"file"},{"name":"ch01-00-getting-started.md","path":"src/ch01-00-getting-started.md","contentType":"file"},{"name":"ch01-01-installation.md","path":"src/ch01-01-installation.md","contentType":"file"},{"name":"ch01-02-hello-world.md","path":"src/ch01-02-hello-world.md","contentType":"file"},{"name":"ch01-03-hello-cargo.md","path":"src/ch01-03-hello-cargo.md","contentType":"file"},{"name":"ch02-00-guessing-game-tutorial.md","path":"src/ch02-00-guessing-game-tutorial.md","contentType":"file"},{"name":"ch03-00-common-programming-concepts.md","path":"src/ch03-00-common-programming-concepts.md","contentType":"file"},{"name":"ch03-01-variables-and-mutability.md","path":"src/ch03-01-variables-and-mutability.md","contentType":"file"},{"name":"ch03-02-data-types.md","path":"src/ch03-02-data-types.md","contentType":"file"},{"name":"ch03-03-how-functions-work.md","path":"src/ch03-03-how-functions-work.md","contentType":"file"},{"name":"ch03-04-comments.md","path":"src/ch03-04-comments.md","contentType":"file"},{"name":"ch03-05-control-flow.md","path":"src/ch03-05-control-flow.md","contentType":"file"},{"name":"ch04-00-understanding-ownership.md","path":"src/ch04-00-understanding-ownership.md","contentType":"file"},{"name":"ch04-01-what-is-ownership.md","path":"src/ch04-01-what-is-ownership.md","contentType":"file"},{"name":"ch04-02-references-and-borrowing.md","path":"src/ch04-02-references-and-borrowing.md","contentType":"file"},{"name":"ch04-03-slices.md","path":"src/ch04-03-slices.md","contentType":"file"},{"name":"ch05-00-structs.md","path":"src/ch05-00-structs.md","contentType":"file"},{"name":"ch05-01-defining-structs.md","path":"src/ch05-01-defining-structs.md","contentType":"file"},{"name":"ch05-02-example-structs.md","path":"src/ch05-02-example-structs.md","contentType":"file"},{"name":"ch05-03-method-syntax.md","path":"src/ch05-03-method-syntax.md","contentType":"file"},{"name":"ch06-00-enums.md","path":"src/ch06-00-enums.md","contentType":"file"},{"name":"ch06-01-defining-an-enum.md","path":"src/ch06-01-defining-an-enum.md","contentType":"file"},{"name":"ch06-02-match.md","path":"src/ch06-02-match.md","contentType":"file"},{"name":"ch06-03-if-let.md","path":"src/ch06-03-if-let.md","contentType":"file"},{"name":"ch07-00-managing-growing-projects-with-packages-crates-and-modules.md","path":"src/ch07-00-managing-growing-projects-with-packages-crates-and-modules.md","contentType":"file"},{"name":"ch07-01-packages-and-crates.md","path":"src/ch07-01-packages-and-crates.md","contentType":"file"},{"name":"ch07-02-defining-modules-to-control-scope-and-privacy.md","path":"src/ch07-02-defining-modules-to-control-scope-and-privacy.md","contentType":"file"},{"name":"ch07-03-paths-for-referring-to-an-item-in-the-module-tree.md","path":"src/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.md","contentType":"file"},{"name":"ch07-04-bringing-paths-into-scope-with-the-use-keyword.md","path":"src/ch07-04-bringing-paths-into-scope-with-the-use-keyword.md","contentType":"file"},{"name":"ch07-05-separating-modules-into-different-files.md","path":"src/ch07-05-separating-modules-into-different-files.md","contentType":"file"},{"name":"ch08-00-common-collections.md","path":"src/ch08-00-common-collections.md","contentType":"file"},{"name":"ch08-01-vectors.md","path":"src/ch08-01-vectors.md","contentType":"file"},{"name":"ch08-02-strings.md","path":"src/ch08-02-strings.md","contentType":"file"},{"name":"ch08-03-hash-maps.md","path":"src/ch08-03-hash-maps.md","contentType":"file"},{"name":"ch09-00-error-handling.md","path":"src/ch09-00-error-handling.md","contentType":"file"},{"name":"ch09-01-unrecoverable-errors-with-panic.md","path":"src/ch09-01-unrecoverable-errors-with-panic.md","contentType":"file"},{"name":"ch09-02-recoverable-errors-with-result.md","path":"src/ch09-02-recoverable-errors-with-result.md","contentType":"file"},{"name":"ch09-03-to-panic-or-not-to-panic.md","path":"src/ch09-03-to-panic-or-not-to-panic.md","contentType":"file"},{"name":"ch10-00-generics.md","path":"src/ch10-00-generics.md","contentType":"file"},{"name":"ch10-01-syntax.md","path":"src/ch10-01-syntax.md","contentType":"file"},{"name":"ch10-02-traits.md","path":"src/ch10-02-traits.md","contentType":"file"},{"name":"ch10-03-lifetime-syntax.md","path":"src/ch10-03-lifetime-syntax.md","contentType":"file"},{"name":"ch11-00-testing.md","path":"src/ch11-00-testing.md","contentType":"file"},{"name":"ch11-01-writing-tests.md","path":"src/ch11-01-writing-tests.md","contentType":"file"},{"name":"ch11-02-running-tests.md","path":"src/ch11-02-running-tests.md","contentType":"file"},{"name":"ch11-03-test-organization.md","path":"src/ch11-03-test-organization.md","contentType":"file"},{"name":"ch12-00-an-io-project.md","path":"src/ch12-00-an-io-project.md","contentType":"file"},{"name":"ch12-01-accepting-command-line-arguments.md","path":"src/ch12-01-accepting-command-line-arguments.md","contentType":"file"},{"name":"ch12-02-reading-a-file.md","path":"src/ch12-02-reading-a-file.md","contentType":"file"},{"name":"ch12-03-improving-error-handling-and-modularity.md","path":"src/ch12-03-improving-error-handling-and-modularity.md","contentType":"file"},{"name":"ch12-04-testing-the-librarys-functionality.md","path":"src/ch12-04-testing-the-librarys-functionality.md","contentType":"file"},{"name":"ch12-05-working-with-environment-variables.md","path":"src/ch12-05-working-with-environment-variables.md","contentType":"file"},{"name":"ch12-06-writing-to-stderr-instead-of-stdout.md","path":"src/ch12-06-writing-to-stderr-instead-of-stdout.md","contentType":"file"},{"name":"ch13-00-functional-features.md","path":"src/ch13-00-functional-features.md","contentType":"file"},{"name":"ch13-01-closures.md","path":"src/ch13-01-closures.md","contentType":"file"},{"name":"ch13-02-iterators.md","path":"src/ch13-02-iterators.md","contentType":"file"},{"name":"ch13-03-improving-our-io-project.md","path":"src/ch13-03-improving-our-io-project.md","contentType":"file"},{"name":"ch13-04-performance.md","path":"src/ch13-04-performance.md","contentType":"file"},{"name":"ch14-00-more-about-cargo.md","path":"src/ch14-00-more-about-cargo.md","contentType":"file"},{"name":"ch14-01-release-profiles.md","path":"src/ch14-01-release-profiles.md","contentType":"file"},{"name":"ch14-02-publishing-to-crates-io.md","path":"src/ch14-02-publishing-to-crates-io.md","contentType":"file"},{"name":"ch14-03-cargo-workspaces.md","path":"src/ch14-03-cargo-workspaces.md","contentType":"file"},{"name":"ch14-04-installing-binaries.md","path":"src/ch14-04-installing-binaries.md","contentType":"file"},{"name":"ch14-05-extending-cargo.md","path":"src/ch14-05-extending-cargo.md","contentType":"file"},{"name":"ch15-00-smart-pointers.md","path":"src/ch15-00-smart-pointers.md","contentType":"file"},{"name":"ch15-01-box.md","path":"src/ch15-01-box.md","contentType":"file"},{"name":"ch15-02-deref.md","path":"src/ch15-02-deref.md","contentType":"file"},{"name":"ch15-03-drop.md","path":"src/ch15-03-drop.md","contentType":"file"},{"name":"ch15-04-rc.md","path":"src/ch15-04-rc.md","contentType":"file"},{"name":"ch15-05-interior-mutability.md","path":"src/ch15-05-interior-mutability.md","contentType":"file"},{"name":"ch15-06-reference-cycles.md","path":"src/ch15-06-reference-cycles.md","contentType":"file"},{"name":"ch16-00-concurrency.md","path":"src/ch16-00-concurrency.md","contentType":"file"},{"name":"ch16-01-threads.md","path":"src/ch16-01-threads.md","contentType":"file"},{"name":"ch16-02-message-passing.md","path":"src/ch16-02-message-passing.md","contentType":"file"},{"name":"ch16-03-shared-state.md","path":"src/ch16-03-shared-state.md","contentType":"file"},{"name":"ch16-04-extensible-concurrency-sync-and-send.md","path":"src/ch16-04-extensible-concurrency-sync-and-send.md","contentType":"file"},{"name":"ch17-00-oop.md","path":"src/ch17-00-oop.md","contentType":"file"},{"name":"ch17-01-what-is-oo.md","path":"src/ch17-01-what-is-oo.md","contentType":"file"},{"name":"ch17-02-trait-objects.md","path":"src/ch17-02-trait-objects.md","contentType":"file"},{"name":"ch17-03-oo-design-patterns.md","path":"src/ch17-03-oo-design-patterns.md","contentType":"file"},{"name":"ch18-00-patterns.md","path":"src/ch18-00-patterns.md","contentType":"file"},{"name":"ch18-01-all-the-places-for-patterns.md","path":"src/ch18-01-all-the-places-for-patterns.md","contentType":"file"},{"name":"ch18-02-refutability.md","path":"src/ch18-02-refutability.md","contentType":"file"},{"name":"ch18-03-pattern-syntax.md","path":"src/ch18-03-pattern-syntax.md","contentType":"file"},{"name":"ch19-00-advanced-features.md","path":"src/ch19-00-advanced-features.md","contentType":"file"},{"name":"ch19-01-unsafe-rust.md","path":"src/ch19-01-unsafe-rust.md","contentType":"file"},{"name":"ch19-03-advanced-traits.md","path":"src/ch19-03-advanced-traits.md","contentType":"file"},{"name":"ch19-04-advanced-types.md","path":"src/ch19-04-advanced-types.md","contentType":"file"},{"name":"ch19-05-advanced-functions-and-closures.md","path":"src/ch19-05-advanced-functions-and-closures.md","contentType":"file"},{"name":"ch19-06-macros.md","path":"src/ch19-06-macros.md","contentType":"file"},{"name":"ch20-00-final-project-a-web-server.md","path":"src/ch20-00-final-project-a-web-server.md","contentType":"file"},{"name":"ch20-01-single-threaded.md","path":"src/ch20-01-single-threaded.md","contentType":"file"},{"name":"ch20-02-multithreaded.md","path":"src/ch20-02-multithreaded.md","contentType":"file"},{"name":"ch20-03-graceful-shutdown-and-cleanup.md","path":"src/ch20-03-graceful-shutdown-and-cleanup.md","contentType":"file"},{"name":"foreword.md","path":"src/foreword.md","contentType":"file"},{"name":"title-page.md","path":"src/title-page.md","contentType":"file"}],"totalCount":106},"":{"items":[{"name":".cargo","path":".cargo","contentType":"directory"},{"name":".github","path":".github","contentType":"directory"},{"name":"2018-edition","path":"2018-edition","contentType":"directory"},{"name":"ci","path":"ci","contentType":"directory"},{"name":"dot","path":"dot","contentType":"directory"},{"name":"first-edition","path":"first-edition","contentType":"directory"},{"name":"listings","path":"listings","contentType":"directory"},{"name":"nostarch","path":"nostarch","contentType":"directory"},{"name":"redirects","path":"redirects","contentType":"directory"},{"name":"second-edition","path":"second-edition","contentType":"directory"},{"name":"src","path":"src","contentType":"directory"},{"name":"theme","path":"theme","contentType":"directory"},{"name":"tools","path":"tools","contentType":"directory"},{"name":".gitattributes","path":".gitattributes","contentType":"file"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"ADMIN_TASKS.md","path":"ADMIN_TASKS.md","contentType":"file"},{"name":"CONTRIBUTING.md","path":"CONTRIBUTING.md","contentType":"file"},{"name":"COPYRIGHT","path":"COPYRIGHT","contentType":"file"},{"name":"Cargo.lock","path":"Cargo.lock","contentType":"file"},{"name":"Cargo.toml","path":"Cargo.toml","contentType":"file"},{"name":"LICENSE-APACHE","path":"LICENSE-APACHE","contentType":"file"},{"name":"LICENSE-MIT","path":"LICENSE-MIT","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"TODO.md","path":"TODO.md","contentType":"file"},{"name":"book.toml","path":"book.toml","contentType":"file"},{"name":"ferris.css","path":"ferris.css","contentType":"file"},{"name":"ferris.js","path":"ferris.js","contentType":"file"},{"name":"rust-toolchain","path":"rust-toolchain","contentType":"file"},{"name":"rustfmt.toml","path":"rustfmt.toml","contentType":"file"},{"name":"style-guide.md","path":"style-guide.md","contentType":"file"}],"totalCount":30}},"fileTreeProcessingTime":15.350719,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":47854924,"defaultBranch":"main","name":"book","ownerLogin":"rust-lang","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2015-12-11T22:49:49.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/5430905?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1688046669.0","canEdit":false,"refType":"branch","currentOid":"72187f5cd0beaaa9c6f584156bcd88f921871e83"},"path":"src/ch11-01-writing-tests.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/rust-lang/book/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/rust-lang/book/security/dependabot","repoSecurityAndAnalysisPath":"/rust-lang/book/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"ch11-01-writing-tests.md","displayUrl":"https://github.com/rust-lang/book/blob/main/src/ch11-01-writing-tests.md?raw=true","headerInfo":{"blobSize":"24.4 KB","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"df09aad","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang%2Fbook%2Fblob%2Fmain%2Fsrc%2Fch11-01-writing-tests.md","isCSV":false,"isRichtext":true,"toc":[{"level":2,"text":"How to Write Tests","anchor":"how-to-write-tests","htmlText":"How to Write Tests"},{"level":3,"text":"The Anatomy of a Test Function","anchor":"the-anatomy-of-a-test-function","htmlText":"The Anatomy of a Test Function"},{"level":3,"text":"Checking Results with the assert! Macro","anchor":"checking-results-with-the-assert-macro","htmlText":"Checking Results with the assert! Macro"},{"level":3,"text":"Testing Equality with the assert_eq! and assert_ne! Macros","anchor":"testing-equality-with-the-assert_eq-and-assert_ne-macros","htmlText":"Testing Equality with the assert_eq! and assert_ne! Macros"},{"level":3,"text":"Adding Custom Failure Messages","anchor":"adding-custom-failure-messages","htmlText":"Adding Custom Failure Messages"},{"level":3,"text":"Checking for Panics with should_panic","anchor":"checking-for-panics-with-should_panic","htmlText":"Checking for Panics with should_panic"},{"level":3,"text":"Using Result<T, E> in Tests","anchor":"using-resultt-e-in-tests","htmlText":"Using Result&lt;T, E&gt; in Tests"}],"lineInfo":{"truncatedLoc":"542","truncatedSloc":"417"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"loggedIn":false,"newDiscussionPath":"/rust-lang/book/discussions/new","newIssuePath":"/rust-lang/book/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/rust-lang/book/blob/main/src/ch11-01-writing-tests.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/rust-lang/book/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><h2 tabindex=\"-1\" id=\"user-content-how-to-write-tests\" dir=\"auto\"><a class=\"heading-link\" href=\"#how-to-write-tests\">How to Write Tests<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h2>\n<p dir=\"auto\">Tests are Rust functions that verify that the non-test code is functioning in\nthe expected manner. The bodies of test functions typically perform these three\nactions:</p>\n<ol dir=\"auto\">\n<li>Set up any needed data or state.</li>\n<li>Run the code you want to test.</li>\n<li>Assert the results are what you expect.</li>\n</ol>\n<p dir=\"auto\">Let’s look at the features Rust provides specifically for writing tests that\ntake these actions, which include the <code>test</code> attribute, a few macros, and the\n<code>should_panic</code> attribute.</p>\n<h3 tabindex=\"-1\" id=\"user-content-the-anatomy-of-a-test-function\" dir=\"auto\"><a class=\"heading-link\" href=\"#the-anatomy-of-a-test-function\">The Anatomy of a Test Function<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">At its simplest, a test in Rust is a function that’s annotated with the <code>test</code>\nattribute. Attributes are metadata about pieces of Rust code; one example is\nthe <code>derive</code> attribute we used with structs in Chapter 5. To change a function\ninto a test function, add <code>#[test]</code> on the line before <code>fn</code>. When you run your\ntests with the <code>cargo test</code> command, Rust builds a test runner binary that runs\nthe annotated functions and reports on whether each\ntest function passes or fails.</p>\n<p dir=\"auto\">Whenever we make a new library project with Cargo, a test module with a test\nfunction in it is automatically generated for us. This module gives you a\ntemplate for writing your tests so you don’t have to look up the exact\nstructure and syntax every time you start a new project. You can add as many\nadditional test functions and as many test modules as you want!</p>\n<p dir=\"auto\">We’ll explore some aspects of how tests work by experimenting with the template\ntest before we actually test any code. Then we’ll write some real-world tests\nthat call some code that we’ve written and assert that its behavior is correct.</p>\n<p dir=\"auto\">Let’s create a new library project called <code>adder</code> that will add two numbers:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$ cargo new adder --lib\n     Created library `adder` project\n$ cd adder\"><pre>$ <span class=\"pl-s1\">cargo new adder --lib</span>\n<span class=\"pl-c1\">     Created library `adder` project</span>\n$ <span class=\"pl-s1\"><span class=\"pl-c1\">cd</span> adder</span></pre></div>\n<p dir=\"auto\">The contents of the <em>src/lib.rs</em> file in your <code>adder</code> library should look like\nListing 11-1.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-01/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">01</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-1: The test module and function generated\nautomatically by <code>cargo new</code></span></p>\n<p dir=\"auto\">For now, let’s ignore the top two lines and focus on the function. Note the\n<code>#[test]</code> annotation: this attribute indicates this is a test function, so the\ntest runner knows to treat this function as a test. We might also have non-test\nfunctions in the <code>tests</code> module to help set up common scenarios or perform\ncommon operations, so we always need to indicate which functions are tests.</p>\n<p dir=\"auto\">The example function body uses the <code>assert_eq!</code> macro to assert that <code>result</code>,\nwhich contains the result of adding 2 and 2, equals 4. This assertion serves as\nan example of the format for a typical test. Let’s run it to see that this test\npasses.</p>\n<p dir=\"auto\">The <code>cargo test</code> command runs all tests in our project, as shown in Listing\n11-2.</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/listing-11-01/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/listing-11-01/output.txt}}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-2: The output from running the automatically\ngenerated test</span></p>\n<p dir=\"auto\">Cargo compiled and ran the test. We see the line <code>running 1 test</code>. The next\nline shows the name of the generated test function, called <code>it_works</code>, and that\nthe result of running that test is <code>ok</code>. The overall summary <code>test result: ok.</code>\nmeans that all the tests passed, and the portion that reads <code>1 passed; 0 failed</code> totals the number of tests that passed or failed.</p>\n<p dir=\"auto\">It’s possible to mark a test as ignored so it doesn’t run in a particular\ninstance; we’ll cover that in the <a href=\"/rust-lang/book/blob/main/src/ch11-02-running-tests.html#ignoring-some-tests-unless-specifically-requested\">“Ignoring Some Tests Unless Specifically\nRequested”</a> section later in this chapter. Because we\nhaven’t done that here, the summary shows <code>0 ignored</code>. We can also pass an\nargument to the <code>cargo test</code> command to run only tests whose name matches a\nstring; this is called <em>filtering</em> and we’ll cover that in the <a href=\"/rust-lang/book/blob/main/src/ch11-02-running-tests.html#running-a-subset-of-tests-by-name\">“Running a\nSubset of Tests by Name”</a> section. We also haven’t\nfiltered the tests being run, so the end of the summary shows <code>0 filtered out</code>.</p>\n<p dir=\"auto\">The <code>0 measured</code> statistic is for benchmark tests that measure performance.\nBenchmark tests are, as of this writing, only available in nightly Rust. See\n<a href=\"/rust-lang/book/blob/main/unstable-book/library-features/test.html\">the documentation about benchmark tests</a> to learn more.</p>\n<p dir=\"auto\">The next part of the test output starting at <code>Doc-tests adder</code> is for the\nresults of any documentation tests. We don’t have any documentation tests yet,\nbut Rust can compile any code examples that appear in our API documentation.\nThis feature helps keep your docs and your code in sync! We’ll discuss how to\nwrite documentation tests in the <a href=\"/rust-lang/book/blob/main/src/ch14-02-publishing-to-crates-io.html#documentation-comments-as-tests\">“Documentation Comments as\nTests”</a> section of Chapter 14. For now, we’ll\nignore the <code>Doc-tests</code> output.</p>\n<p dir=\"auto\">Let’s start to customize the test to our own needs. First change the name of\nthe <code>it_works</code> function to a different name, such as <code>exploration</code>, like so:</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-01-changing-test-name/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">01</span>-changing-test-name/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Then run <code>cargo test</code> again. The output now shows <code>exploration</code> instead of\n<code>it_works</code>:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-01-changing-test-name/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-01-changing-test-name/output.txt}}</span></pre></div>\n<p dir=\"auto\">Now we’ll add another test, but this time we’ll make a test that fails! Tests\nfail when something in the test function panics. Each test is run in a new\nthread, and when the main thread sees that a test thread has died, the test is\nmarked as failed. In Chapter 9, we talked about how the simplest way to panic\nis to call the <code>panic!</code> macro. Enter the new test as a function named\n<code>another</code>, so your <em>src/lib.rs</em> file looks like Listing 11-3.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-03/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">03</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-3: Adding a second test that will fail because\nwe call the <code>panic!</code> macro</span></p>\n<p dir=\"auto\">Run the tests again using <code>cargo test</code>. The output should look like Listing\n11-4, which shows that our <code>exploration</code> test passed and <code>another</code> failed.</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/listing-11-03/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/listing-11-03/output.txt}}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-4: Test results when one test passes and one\ntest fails</span></p>\n<p dir=\"auto\">Instead of <code>ok</code>, the line <code>test tests::another</code> shows <code>FAILED</code>. Two new\nsections appear between the individual results and the summary: the first\ndisplays the detailed reason for each test failure. In this case, we get the\ndetails that <code>another</code> failed because it <code>panicked at 'Make this test fail'</code> on\nline 10 in the <em>src/lib.rs</em> file. The next section lists just the names of all\nthe failing tests, which is useful when there are lots of tests and lots of\ndetailed failing test output. We can use the name of a failing test to run just\nthat test to more easily debug it; we’ll talk more about ways to run tests in\nthe <a href=\"/rust-lang/book/blob/main/src/ch11-02-running-tests.html#controlling-how-tests-are-run\">“Controlling How Tests Are Run”</a> section.</p>\n<p dir=\"auto\">The summary line displays at the end: overall, our test result is <code>FAILED</code>. We\nhad one test pass and one test fail.</p>\n<p dir=\"auto\">Now that you’ve seen what the test results look like in different scenarios,\nlet’s look at some macros other than <code>panic!</code> that are useful in tests.</p>\n<h3 tabindex=\"-1\" id=\"user-content-checking-results-with-the-assert-macro\" dir=\"auto\"><a class=\"heading-link\" href=\"#checking-results-with-the-assert-macro\">Checking Results with the <code>assert!</code> Macro<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">The <code>assert!</code> macro, provided by the standard library, is useful when you want\nto ensure that some condition in a test evaluates to <code>true</code>. We give the\n<code>assert!</code> macro an argument that evaluates to a Boolean. If the value is\n<code>true</code>, nothing happens and the test passes. If the value is <code>false</code>, the\n<code>assert!</code> macro calls <code>panic!</code> to cause the test to fail. Using the <code>assert!</code>\nmacro helps us check that our code is functioning in the way we intend.</p>\n<p dir=\"auto\">In Chapter 5, Listing 5-15, we used a <code>Rectangle</code> struct and a <code>can_hold</code>\nmethod, which are repeated here in Listing 11-5. Let’s put this code in the\n<em>src/lib.rs</em> file, then write some tests for it using the <code>assert!</code> macro.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-05/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">05</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-5: Using the <code>Rectangle</code> struct and its\n<code>can_hold</code> method from Chapter 5</span></p>\n<p dir=\"auto\">The <code>can_hold</code> method returns a Boolean, which means it’s a perfect use case\nfor the <code>assert!</code> macro. In Listing 11-6, we write a test that exercises the\n<code>can_hold</code> method by creating a <code>Rectangle</code> instance that has a width of 8 and\na height of 7 and asserting that it can hold another <code>Rectangle</code> instance that\nhas a width of 5 and a height of 1.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-06/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">06</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-6: A test for <code>can_hold</code> that checks whether a\nlarger rectangle can indeed hold a smaller rectangle</span></p>\n<p dir=\"auto\">Note that we’ve added a new line inside the <code>tests</code> module: <code>use super::*;</code>.\nThe <code>tests</code> module is a regular module that follows the usual visibility rules\nwe covered in Chapter 7 in the <a href=\"/rust-lang/book/blob/main/src/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html\">“Paths for Referring to an Item in the Module\nTree”</a>\nsection. Because the <code>tests</code> module is an inner module, we need to bring the\ncode under test in the outer module into the scope of the inner module. We use\na glob here so anything we define in the outer module is available to this\n<code>tests</code> module.</p>\n<p dir=\"auto\">We’ve named our test <code>larger_can_hold_smaller</code>, and we’ve created the two\n<code>Rectangle</code> instances that we need. Then we called the <code>assert!</code> macro and\npassed it the result of calling <code>larger.can_hold(&amp;smaller)</code>. This expression is\nsupposed to return <code>true</code>, so our test should pass. Let’s find out!</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/listing-11-06/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/listing-11-06/output.txt}}</span></pre></div>\n<p dir=\"auto\">It does pass! Let’s add another test, this time asserting that a smaller\nrectangle cannot hold a larger rectangle:</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-02-adding-another-rectangle-test/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">02</span>-adding-another-rectangle-test/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Because the correct result of the <code>can_hold</code> function in this case is <code>false</code>,\nwe need to negate that result before we pass it to the <code>assert!</code> macro. As a\nresult, our test will pass if <code>can_hold</code> returns <code>false</code>:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-02-adding-another-rectangle-test/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-02-adding-another-rectangle-test/output.txt}}</span></pre></div>\n<p dir=\"auto\">Two tests that pass! Now let’s see what happens to our test results when we\nintroduce a bug in our code. We’ll change the implementation of the <code>can_hold</code>\nmethod by replacing the greater-than sign with a less-than sign when it\ncompares the widths:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-03-introducing-a-bug/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">03</span>-introducing-a-bug/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Running the tests now produces the following:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-03-introducing-a-bug/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-03-introducing-a-bug/output.txt}}</span></pre></div>\n<p dir=\"auto\">Our tests caught the bug! Because <code>larger.width</code> is 8 and <code>smaller.width</code> is\n5, the comparison of the widths in <code>can_hold</code> now returns <code>false</code>: 8 is not\nless than 5.</p>\n<h3 tabindex=\"-1\" id=\"user-content-testing-equality-with-the-assert_eq-and-assert_ne-macros\" dir=\"auto\"><a class=\"heading-link\" href=\"#testing-equality-with-the-assert_eq-and-assert_ne-macros\">Testing Equality with the <code>assert_eq!</code> and <code>assert_ne!</code> Macros<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">A common way to verify functionality is to test for equality between the result\nof the code under test and the value you expect the code to return. You could\ndo this using the <code>assert!</code> macro and passing it an expression using the <code>==</code>\noperator. However, this is such a common test that the standard library\nprovides a pair of macros—<code>assert_eq!</code> and <code>assert_ne!</code>—to perform this test\nmore conveniently. These macros compare two arguments for equality or\ninequality, respectively. They’ll also print the two values if the assertion\nfails, which makes it easier to see <em>why</em> the test failed; conversely, the\n<code>assert!</code> macro only indicates that it got a <code>false</code> value for the <code>==</code>\nexpression, without printing the values that led to the <code>false</code> value.</p>\n<p dir=\"auto\">In Listing 11-7, we write a function named <code>add_two</code> that adds <code>2</code> to its\nparameter, then we test this function using the <code>assert_eq!</code> macro.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-07/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">07</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-7: Testing the function <code>add_two</code> using the\n<code>assert_eq!</code> macro</span></p>\n<p dir=\"auto\">Let’s check that it passes!</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/listing-11-07/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/listing-11-07/output.txt}}</span></pre></div>\n<p dir=\"auto\">We pass <code>4</code> as the argument to <code>assert_eq!</code>, which is equal to the result of\ncalling <code>add_two(2)</code>. The line for this test is <code>test tests::it_adds_two ... ok</code>, and the <code>ok</code> text indicates that our test passed!</p>\n<p dir=\"auto\">Let’s introduce a bug into our code to see what <code>assert_eq!</code> looks like when it\nfails. Change the implementation of the <code>add_two</code> function to instead add <code>3</code>:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-04-bug-in-add-two/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">04</span>-bug-in-add-two/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Run the tests again:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-04-bug-in-add-two/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-04-bug-in-add-two/output.txt}}</span></pre></div>\n<p dir=\"auto\">Our test caught the bug! The <code>it_adds_two</code> test failed, and the message tells\nus that the assertion that fails was <code>assertion failed: `(left == right)`</code>\nand what the <code>left</code> and <code>right</code> values are. This message helps us start\ndebugging: the <code>left</code> argument was <code>4</code> but the <code>right</code> argument, where we had\n<code>add_two(2)</code>, was <code>5</code>. You can imagine that this would be especially helpful\nwhen we have a lot of tests going on.</p>\n<p dir=\"auto\">Note that in some languages and test frameworks, the parameters to equality\nassertion functions are called <code>expected</code> and <code>actual</code>, and the order in which\nwe specify the arguments matters. However, in Rust, they’re called <code>left</code> and\n<code>right</code>, and the order in which we specify the value we expect and the value\nthe code produces doesn’t matter. We could write the assertion in this test as\n<code>assert_eq!(add_two(2), 4)</code>, which would result in the same failure message\nthat displays <code>assertion failed: `(left == right)`</code>.</p>\n<p dir=\"auto\">The <code>assert_ne!</code> macro will pass if the two values we give it are not equal and\nfail if they’re equal. This macro is most useful for cases when we’re not sure\nwhat a value <em>will</em> be, but we know what the value definitely <em>shouldn’t</em> be.\nFor example, if we’re testing a function that is guaranteed to change its input\nin some way, but the way in which the input is changed depends on the day of\nthe week that we run our tests, the best thing to assert might be that the\noutput of the function is not equal to the input.</p>\n<p dir=\"auto\">Under the surface, the <code>assert_eq!</code> and <code>assert_ne!</code> macros use the operators\n<code>==</code> and <code>!=</code>, respectively. When the assertions fail, these macros print their\narguments using debug formatting, which means the values being compared must\nimplement the <code>PartialEq</code> and <code>Debug</code> traits. All primitive types and most of\nthe standard library types implement these traits. For structs and enums that\nyou define yourself, you’ll need to implement <code>PartialEq</code> to assert equality of\nthose types. You’ll also need to implement <code>Debug</code> to print the values when the\nassertion fails. Because both traits are derivable traits, as mentioned in\nListing 5-12 in Chapter 5, this is usually as straightforward as adding the\n<code>#[derive(PartialEq, Debug)]</code> annotation to your struct or enum definition. See\nAppendix C, <a href=\"/rust-lang/book/blob/main/src/appendix-03-derivable-traits.html\">“Derivable Traits,”</a> for more\ndetails about these and other derivable traits.</p>\n<h3 tabindex=\"-1\" id=\"user-content-adding-custom-failure-messages\" dir=\"auto\"><a class=\"heading-link\" href=\"#adding-custom-failure-messages\">Adding Custom Failure Messages<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">You can also add a custom message to be printed with the failure message as\noptional arguments to the <code>assert!</code>, <code>assert_eq!</code>, and <code>assert_ne!</code> macros. Any\narguments specified after the required arguments are passed along to the\n<code>format!</code> macro (discussed in Chapter 8 in the <a href=\"/rust-lang/book/blob/main/src/ch08-02-strings.html#concatenation-with-the--operator-or-the-format-macro\">“Concatenation with the <code>+</code>\nOperator or the <code>format!</code>\nMacro”</a>\nsection), so you can pass a format string that contains <code>{}</code> placeholders and\nvalues to go in those placeholders. Custom messages are useful for documenting\nwhat an assertion means; when a test fails, you’ll have a better idea of what\nthe problem is with the code.</p>\n<p dir=\"auto\">For example, let’s say we have a function that greets people by name and we\nwant to test that the name we pass into the function appears in the output:</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-05-greeter/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">05</span>-greeter/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">The requirements for this program haven’t been agreed upon yet, and we’re\npretty sure the <code>Hello</code> text at the beginning of the greeting will change. We\ndecided we don’t want to have to update the test when the requirements change,\nso instead of checking for exact equality to the value returned from the\n<code>greeting</code> function, we’ll just assert that the output contains the text of the\ninput parameter.</p>\n<p dir=\"auto\">Now let’s introduce a bug into this code by changing <code>greeting</code> to exclude\n<code>name</code> to see what the default test failure looks like:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-06-greeter-with-bug/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">06</span>-greeter-with-bug/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Running this test produces the following:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-06-greeter-with-bug/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-06-greeter-with-bug/output.txt}}</span></pre></div>\n<p dir=\"auto\">This result just indicates that the assertion failed and which line the\nassertion is on. A more useful failure message would print the value from the\n<code>greeting</code> function. Let’s add a custom failure message composed of a format\nstring with a placeholder filled in with the actual value we got from the\n<code>greeting</code> function:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-07-custom-failure-message/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">07</span>-custom-failure-message/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">Now when we run the test, we’ll get a more informative error message:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-07-custom-failure-message/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-07-custom-failure-message/output.txt}}</span></pre></div>\n<p dir=\"auto\">We can see the value we actually got in the test output, which would help us\ndebug what happened instead of what we were expecting to happen.</p>\n<h3 tabindex=\"-1\" id=\"user-content-checking-for-panics-with-should_panic\" dir=\"auto\"><a class=\"heading-link\" href=\"#checking-for-panics-with-should_panic\">Checking for Panics with <code>should_panic</code><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">In addition to checking return values, it’s important to check that our code\nhandles error conditions as we expect. For example, consider the <code>Guess</code> type\nthat we created in Chapter 9, Listing 9-13. Other code that uses <code>Guess</code>\ndepends on the guarantee that <code>Guess</code> instances will contain only values\nbetween 1 and 100. We can write a test that ensures that attempting to create a\n<code>Guess</code> instance with a value outside that range panics.</p>\n<p dir=\"auto\">We do this by adding the attribute <code>should_panic</code> to our test function. The\ntest passes if the code inside the function panics; the test fails if the code\ninside the function doesn’t panic.</p>\n<p dir=\"auto\">Listing 11-8 shows a test that checks that the error conditions of <code>Guess::new</code>\nhappen when we expect them to.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-08/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">08</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-8: Testing that a condition will cause a\n<code>panic!</code></span></p>\n<p dir=\"auto\">We place the <code>#[should_panic]</code> attribute after the <code>#[test]</code> attribute and\nbefore the test function it applies to. Let’s look at the result when this test\npasses:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/listing-11-08/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/listing-11-08/output.txt}}</span></pre></div>\n<p dir=\"auto\">Looks good! Now let’s introduce a bug in our code by removing the condition\nthat the <code>new</code> function will panic if the value is greater than 100:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-08-guess-with-bug/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">08</span>-guess-with-bug/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">When we run the test in Listing 11-8, it will fail:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-08-guess-with-bug/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-08-guess-with-bug/output.txt}}</span></pre></div>\n<p dir=\"auto\">We don’t get a very helpful message in this case, but when we look at the test\nfunction, we see that it’s annotated with <code>#[should_panic]</code>. The failure we got\nmeans that the code in the test function did not cause a panic.</p>\n<p dir=\"auto\">Tests that use <code>should_panic</code> can be imprecise. A <code>should_panic</code> test would\npass even if the test panics for a different reason from the one we were\nexpecting. To make <code>should_panic</code> tests more precise, we can add an optional\n<code>expected</code> parameter to the <code>should_panic</code> attribute. The test harness will\nmake sure that the failure message contains the provided text. For example,\nconsider the modified code for <code>Guess</code> in Listing 11-9 where the <code>new</code> function\npanics with different messages depending on whether the value is too small or\ntoo large.</p>\n<p dir=\"auto\"><span>Filename: src/lib.rs</span></p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/listing-11-09/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/listing-<span class=\"pl-c1\">11</span>-<span class=\"pl-c1\">09</span>/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\"><span>Listing 11-9: Testing for a <code>panic!</code> with a panic message\ncontaining a specified substring</span></p>\n<p dir=\"auto\">This test will pass because the value we put in the <code>should_panic</code> attribute’s\n<code>expected</code> parameter is a substring of the message that the <code>Guess::new</code>\nfunction panics with. We could have specified the entire panic message that we\nexpect, which in this case would be <code>Guess value must be less than or equal to 100, got 200.</code> What you choose to specify depends on how much of the panic\nmessage is unique or dynamic and how precise you want your test to be. In this\ncase, a substring of the panic message is enough to ensure that the code in the\ntest function executes the <code>else if value &gt; 100</code> case.</p>\n<p dir=\"auto\">To see what happens when a <code>should_panic</code> test with an <code>expected</code> message\nfails, let’s again introduce a bug into our code by swapping the bodies of the\n<code>if value &lt; 1</code> and the <code>else if value &gt; 100</code> blocks:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-09-guess-with-panic-msg-bug/src/lib.rs:here}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">09</span>-guess-with-panic-msg-bug/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">:</span>here<span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">This time when we run the <code>should_panic</code> test, it will fail:</p>\n<div class=\"highlight highlight-text-shell-session notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#include ../listings/ch11-writing-automated-tests/no-listing-09-guess-with-panic-msg-bug/output.txt}}\"><pre><span class=\"pl-c1\">{{#include ../listings/ch11-writing-automated-tests/no-listing-09-guess-with-panic-msg-bug/output.txt}}</span></pre></div>\n<p dir=\"auto\">The failure message indicates that this test did indeed panic as we expected,\nbut the panic message did not include the expected string <code>'Guess value must be less than or equal to 100'</code>. The panic message that we did get in this case was\n<code>Guess value must be greater than or equal to 1, got 200.</code> Now we can start\nfiguring out where our bug is!</p>\n<h3 tabindex=\"-1\" id=\"user-content-using-resultt-e-in-tests\" dir=\"auto\"><a class=\"heading-link\" href=\"#using-resultt-e-in-tests\">Using <code>Result&lt;T, E&gt;</code> in Tests<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h3>\n<p dir=\"auto\">Our tests so far all panic when they fail. We can also write tests that use\n<code>Result&lt;T, E&gt;</code>! Here’s the test from Listing 11-1, rewritten to use <code>Result&lt;T, E&gt;</code> and return an <code>Err</code> instead of panicking:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-10-result-in-tests/src/lib.rs}}\"><pre><span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span>#rustdoc_include ../listings/ch11-writing-automated-tests/no-listing-<span class=\"pl-c1\">10</span>-result-in-tests/src/lib<span class=\"pl-kos\">.</span><span class=\"pl-c1\">rs</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">The <code>it_works</code> function now has the <code>Result&lt;(), String&gt;</code> return type. In the\nbody of the function, rather than calling the <code>assert_eq!</code> macro, we return\n<code>Ok(())</code> when the test passes and an <code>Err</code> with a <code>String</code> inside when the test\nfails.</p>\n<p dir=\"auto\">Writing tests so they return a <code>Result&lt;T, E&gt;</code> enables you to use the question\nmark operator in the body of tests, which can be a convenient way to write\ntests that should fail if any operation within them returns an <code>Err</code> variant.</p>\n<p dir=\"auto\">You can’t use the <code>#[should_panic]</code> annotation on tests that use <code>Result&lt;T, E&gt;</code>. To assert that an operation returns an <code>Err</code> variant, <em>don’t</em> use the\nquestion mark operator on the <code>Result&lt;T, E&gt;</code> value. Instead, use\n<code>assert!(value.is_err())</code>.</p>\n<p dir=\"auto\">Now that you know several ways to write tests, let’s look at what is happening\nwhen we run our tests and explore the different options we can use with <code>cargo test</code>.</p>\n</article>","renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"rust-lang","repoName":"book","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotInfo":null,"csrf_tokens":{"/rust-lang/book/branches":{"post":"FRIIUzIaA0RvOR9R5Hw_SPUQPp0K4OTPAJdKe-yFb7jfbFXL7hQ3b9s6BKb0MYF64SPWTPksPfDe6OI99vDSwg"},"/repos/preferences":{"post":"XrcqwavLhybYnhNbdYP27DKawT_kxuvMehGz0AawI8M0cyqTSW1mggbBHxVdu9fu6nwaTATcBjvAYbt8QzZXPQ"}}},"title":"book/src/ch11-01-writing-tests.md at main · rust-lang/book"}